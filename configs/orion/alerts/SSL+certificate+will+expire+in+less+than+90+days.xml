<AlertDefinition xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.datacontract.org/2004/07/SolarWinds.Orion.Core.Alerting.Models"><AlertID>111</AlertID><AlertMessage>SSL certificate with subject ${SQL: SELECT cert_subject FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} } issued by ${SQL: SELECT cert_issuer FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} } will expire in ${SQL: SELECT expires_in FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} } days.

SSL certificate is served on port ${SQL: SELECT orion_node_port FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} }

SSL certificate details: 
${SQL: SELECT cert_url FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} }
All alerts related to this certificate can be disabled from the page above (not recommended)

Silence alerts for this SSL certificate (temporarily): 
${SQL: SELECT self_url FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} }</AlertMessage><AlertRefID>c5937981-f65d-4aff-b500-19c53fce816e</AlertRefID><Canned>false</Canned><Category /><CreatedBy>admin</CreatedBy><CustomProperties xmlns:d2p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /><Description>This alert is raised when an SSL certificate expiring in less than 90 days is detected on a managed node</Description><Enabled>true</Enabled><ExecutionTimePeriods xmlns:d2p1="http://schemas.solarwinds.com/2008/Core" /><Frequency>PT1M</Frequency><LastEdit>2019-02-28T21:11:17.8433333Z</LastEdit><Name>SSL certificate will expire in less than 90 days</Name><NotificationEnabled>true</NotificationEnabled><NotificationSettings xmlns:d2p1="http://schemas.solarwinds.com/2008/Core"><d2p1:Enabled>true</d2p1:Enabled><d2p1:NetObjectType>Node</d2p1:NetObjectType><d2p1:Severity>Warning</d2p1:Severity><d2p1:Subject>unutrusted SSL certificate</d2p1:Subject><d2p1:_properties xmlns:d3p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><d3p1:KeyValueOfstringAlertNotificationProperty9sQWCBBt><d3p1:Key>IP Address</d3p1:Key><d3p1:Value><d2p1:Name>IP Address</d2p1:Name><d2p1:Value>${IP_Address}</d2p1:Value></d3p1:Value></d3p1:KeyValueOfstringAlertNotificationProperty9sQWCBBt><d3p1:KeyValueOfstringAlertNotificationProperty9sQWCBBt><d3p1:Key>Object Sub Type</d3p1:Key><d3p1:Value><d2p1:Name>Object Sub Type</d2p1:Name><d2p1:Value>${ObjectSubType}</d2p1:Value></d3p1:Value></d3p1:KeyValueOfstringAlertNotificationProperty9sQWCBBt><d3p1:KeyValueOfstringAlertNotificationProperty9sQWCBBt><d3p1:Key>Status Description</d3p1:Key><d3p1:Value><d2p1:Name>Status Description</d2p1:Name><d2p1:Value>${StatusDescription}</d2p1:Value></d3p1:Value></d3p1:KeyValueOfstringAlertNotificationProperty9sQWCBBt><d3p1:KeyValueOfstringAlertNotificationProperty9sQWCBBt><d3p1:Key>Node Name</d3p1:Key><d3p1:Value><d2p1:Name>Node Name</d2p1:Name><d2p1:Value>${SysName}</d2p1:Value></d3p1:Value></d3p1:KeyValueOfstringAlertNotificationProperty9sQWCBBt><d3p1:KeyValueOfstringAlertNotificationProperty9sQWCBBt><d3p1:Key>Vendor</d3p1:Key><d3p1:Value><d2p1:Name>Vendor</d2p1:Name><d2p1:Value>${Vendor}</d2p1:Value></d3p1:Value></d3p1:KeyValueOfstringAlertNotificationProperty9sQWCBBt></d2p1:_properties></NotificationSettings><ObjectType>Node</ObjectType><Reset><Conditions><ConditionChainItem><AndThenTimeInterval i:nil="true" /><ChainType>ResetInverseToTrigger</ChainType><Condition xmlns:d5p1="http://schemas.datacontract.org/2004/07/SolarWinds.Orion.Core.Models.Alerting" i:nil="true" /><ConjunctionOperator>None</ConjunctionOperator><IsInvertedMinCountThreshold>false</IsInvertedMinCountThreshold><NetObjectsMinCountThreshold i:nil="true" /><ObjectType i:nil="true" /><SustainTime i:nil="true" /><Type i:nil="true" /></ConditionChainItem></Conditions></Reset><ResetActions xmlns:d2p1="http://schemas.solarwinds.com/2008/Orion" /><Severity>Warning</Severity><Trigger><Conditions><ConditionChainItem><AndThenTimeInterval i:nil="true" /><ChainType>Trigger</ChainType><Condition xmlns:d5p1="http://schemas.datacontract.org/2004/07/SolarWinds.Orion.Core.Models.Alerting" xmlns:d5p2="http://schemas.datacontract.org/2004/07/SolarWinds.Orion.Core.Alerting.Plugins.Conditions.Sql" i:type="d5p2:AlertConditionCustomSql"><d5p2:Command>JOIN orion_aux_db.dbo.orion_flash_expiressoonsslalert ON orion_aux_db.dbo.orion_flash_expiressoonsslalert.orion_node_id = Nodes.NodeID
WHERE orion_aux_db.dbo.orion_flash_expiressoonsslalert.silenced = 0
AND orion_aux_db.dbo.orion_flash_expiressoonsslalert.expires_in_lt = 90</d5p2:Command></Condition><ConjunctionOperator>None</ConjunctionOperator><IsInvertedMinCountThreshold>false</IsInvertedMinCountThreshold><NetObjectsMinCountThreshold i:nil="true" /><ObjectType>Node</ObjectType><SustainTime i:nil="true" /><Type xmlns:d5p1="http://schemas.datacontract.org/2004/07/SolarWinds.Orion.Core.Alerting.Plugins.Conditions.Sql" i:type="d5p1:ConditionTypeCustomSql" /></ConditionChainItem></Conditions></Trigger><TriggerActions xmlns:d2p1="http://schemas.solarwinds.com/2008/Orion"><d2p1:ActionDefinition><d2p1:ActionProperties><d2p1:ActionProperty><d2p1:IsShared>false</d2p1:IsShared><d2p1:PropertyName>EmailBCC</d2p1:PropertyName><d2p1:PropertyValue /></d2p1:ActionProperty><d2p1:ActionProperty><d2p1:IsShared>false</d2p1:IsShared><d2p1:PropertyName>EmailCC</d2p1:PropertyName><d2p1:PropertyValue /></d2p1:ActionProperty><d2p1:ActionProperty><d2p1:IsShared>false</d2p1:IsShared><d2p1:PropertyName>EmailFrom</d2p1:PropertyName><d2p1:PropertyValue>serban.teodorescu@phsa.ca</d2p1:PropertyValue></d2p1:ActionProperty><d2p1:ActionProperty><d2p1:IsShared>false</d2p1:IsShared><d2p1:PropertyName>EmailMessage</d2p1:PropertyName><d2p1:PropertyValue>WARNING: An SSL certificate that will expire in 90 days or less has been detected on ${N=SwisEntity;M=MachineType} device named ${N=SwisEntity;M=Caption} (IP: ${N=SwisEntity;M=IP_Address}, DNS: ${N=SwisEntity;M=DNS}) on port: ${SQL: SELECT orion_node_port FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} }

SSL certificate with subject ${SQL: SELECT cert_subject FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} } issued by ${SQL: SELECT cert_issuer FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} } will expire in ${SQL: SELECT expires_in FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} } days.

SSL certificate is served on port ${SQL: SELECT orion_node_port FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} }

SSL certificate details: 
${SQL: SELECT cert_url FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} }
All alerts related to this certificate can be disabled from the page above (not recommended)

Silence alerts for this SSL certificate (temporarily): 
${SQL: SELECT self_url FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} }

View full device details here: ${N=SwisEntity;M=DetailsUrl}.

View full alert details here: ${N=Alerting;M=AlertDetailsUrl}

Click here to acknowledge the alert: ${N=Alerting;M=AcknowledgeUrl}


This message was brought to you by the alert named: ${N=Alerting;M=AlertName}
The node is monitored by the polling engine ${N=SwisEntity;M=Engine.ServerName}</d2p1:PropertyValue></d2p1:ActionProperty><d2p1:ActionProperty><d2p1:IsShared>false</d2p1:IsShared><d2p1:PropertyName>EmailTo</d2p1:PropertyName><d2p1:PropertyValue>serban.teodorescu@phsa.ca,james.reilly@hssbc.ca,leonard.mooney@phsa.ca</d2p1:PropertyValue></d2p1:ActionProperty><d2p1:ActionProperty><d2p1:IsShared>false</d2p1:IsShared><d2p1:PropertyName>EscalationLevel</d2p1:PropertyName><d2p1:PropertyValue>0</d2p1:PropertyValue></d2p1:ActionProperty><d2p1:ActionProperty><d2p1:IsShared>false</d2p1:IsShared><d2p1:PropertyName>executionIfAknowledge</d2p1:PropertyName><d2p1:PropertyValue>True</d2p1:PropertyValue></d2p1:ActionProperty><d2p1:ActionProperty><d2p1:IsShared>false</d2p1:IsShared><d2p1:PropertyName>executionRepeatTimeSpan</d2p1:PropertyName><d2p1:PropertyValue>0</d2p1:PropertyValue></d2p1:ActionProperty><d2p1:ActionProperty><d2p1:IsShared>false</d2p1:IsShared><d2p1:PropertyName>MessageContentType</d2p1:PropertyName><d2p1:PropertyValue>0</d2p1:PropertyValue></d2p1:ActionProperty><d2p1:ActionProperty><d2p1:IsShared>false</d2p1:IsShared><d2p1:PropertyName>Priority</d2p1:PropertyName><d2p1:PropertyValue>0</d2p1:PropertyValue></d2p1:ActionProperty><d2p1:ActionProperty><d2p1:IsShared>false</d2p1:IsShared><d2p1:PropertyName>Sender</d2p1:PropertyName><d2p1:PropertyValue>serban</d2p1:PropertyValue></d2p1:ActionProperty><d2p1:ActionProperty><d2p1:IsShared>false</d2p1:IsShared><d2p1:PropertyName>SmtpServerID</d2p1:PropertyName><d2p1:PropertyValue /></d2p1:ActionProperty><d2p1:ActionProperty><d2p1:IsShared>false</d2p1:IsShared><d2p1:PropertyName>Subject</d2p1:PropertyName><d2p1:PropertyValue>WARNING: SSL certificate on ${N=SwisEntity;M=Caption} , ${N=SwisEntity;M=IP_Address}:${SQL: SELECT orion_node_port FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} } will expire in less than ${SQL: SELECT expires_in_lt FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} } days at ${N=Alerting;M=AlertTriggerTime;F=DateTime}</d2p1:PropertyValue></d2p1:ActionProperty></d2p1:ActionProperties><d2p1:ActionTypeID>Email</d2p1:ActionTypeID><d2p1:Description>To: serban.teodorescu@phsa.ca,james.reilly@hssbc.ca,leonard.mooney@phsa.ca &lt;br/&gt;From: serban.teodorescu@phsa.ca&lt;br/&gt;Subject: WARNING: SSL certificate on ${N=SwisEntity;M=Caption} , ${N=SwisEntity;M=IP_Address}:${SQL: SELECT orion_node_port FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} } will expire in less than ${SQL: SELECT expires_in_lt FROM orion_aux_db.dbo.orion_flash_expiressoonsslalert where orion_node_id =${N=SwisEntity;M=NodeID} } days at ${N=Alerting;M=AlertTriggerTime;F=DateTime}</d2p1:Description><d2p1:Enabled>true</d2p1:Enabled><d2p1:ID>170</d2p1:ID><d2p1:IconPath i:nil="true" /><d2p1:IsShared>false</d2p1:IsShared><d2p1:Order>1</d2p1:Order><d2p1:TimePeriods xmlns:d4p1="http://schemas.solarwinds.com/2008/Core" /><d2p1:Title>Send an Email/Page (SSL certificate will expire in less than 90 days on ${N=SwisEntity;M=Caption} at ${N=Alerting;M=AlertTriggerTime;F=DateTime})</d2p1:Title><d2p1:TransitiveID i:nil="true" /></d2p1:ActionDefinition></TriggerActions><Uri>swis://sdappswor001.healthbc.org/Orion/Orion.AlertConfigurations/AlertID=111</Uri></AlertDefinition>